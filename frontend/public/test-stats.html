<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Estad√≠sticas IA</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .stats-container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .stat-item {
            margin: 10px 0;
            padding: 10px;
            background: #3a3a3a;
            border-radius: 5px;
        }
        .group-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .group-item {
            background: #4a4a4a;
            padding: 15px;
            border-radius: 8px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .error {
            background: #dc3545;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background: #28a745;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ Prueba de Estad√≠sticas de IA</h1>
    
    <div>
        <button onclick="testStats()">üîÑ Cargar Estad√≠sticas</button>
        <button onclick="testPrediction()">üé≤ Hacer Predicci√≥n</button>
        <button onclick="clearResults()">üóëÔ∏è Limpiar</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        const API_BASE = 'http://localhost:5000';
        
        async function testStats() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div>‚è≥ Cargando estad√≠sticas...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/ai/stats`);
                const data = await response.json();
                
                console.log('üìä Respuesta completa:', data);
                
                if (!data.success) {
                    throw new Error(data.error || 'Error desconocido');
                }
                
                const stats = data.data;
                
                resultsDiv.innerHTML = `
                    <div class="success">‚úÖ Estad√≠sticas cargadas correctamente</div>
                    <div class="stats-container">
                        <h2>üìä Estad√≠sticas Generales</h2>
                        <div class="stat-item">
                            <strong>Total Victorias:</strong> ${stats.total_wins || 0}
                        </div>
                        <div class="stat-item">
                            <strong>Total Derrotas:</strong> ${stats.total_losses || 0}
                        </div>
                        <div class="stat-item">
                            <strong>Total Predicciones:</strong> ${stats.total_predictions || 0}
                        </div>
                        <div class="stat-item">
                            <strong>Tasa de √âxito:</strong> ${stats.overall_win_rate || 0}%
                        </div>
                        <div class="stat-item">
                            <strong>Predicciones Pendientes:</strong> ${stats.pending_predictions || 0}
                        </div>
                        
                        <h3>üéØ Estad√≠sticas por Grupo</h3>
                        <div class="group-stats">
                            ${Object.entries(stats.group_stats || {}).map(([groupName, groupStats]) => `
                                <div class="group-item">
                                    <h4>${groupName.replace('group_', 'Grupo ')}</h4>
                                    <div>Victorias: ${groupStats.wins || 0}</div>
                                    <div>Derrotas: ${groupStats.losses || 0}</div>
                                    <div>Total: ${groupStats.total || 0}</div>
                                    <div>√âxito: ${groupStats.win_rate || 0}%</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultsDiv.innerHTML = `
                    <div class="error">‚ùå Error al cargar estad√≠sticas: ${error.message}</div>
                `;
            }
        }
        
        async function testPrediction() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div>‚è≥ Generando predicci√≥n...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/ai/predict`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ type: 'groups' })
                });
                
                const data = await response.json();
                console.log('üé≤ Predicci√≥n:', data);
                
                if (!data.success) {
                    throw new Error(data.error || 'Error desconocido');
                }
                
                const prediction = data.data;
                
                resultsDiv.innerHTML = `
                    <div class="success">‚úÖ Predicci√≥n generada correctamente</div>
                    <div class="stats-container">
                        <h2>üé≤ Nueva Predicci√≥n</h2>
                        <div class="stat-item">
                            <strong>ID:</strong> ${prediction.prediction_id}
                        </div>
                        <div class="stat-item">
                            <strong>Confianza:</strong> ${Math.round(prediction.confidence * 100)}%
                        </div>
                        <div class="stat-item">
                            <strong>Grupos:</strong> ${Object.keys(prediction.prediction_groups || {}).length}
                        </div>
                        
                        <h3>üéØ Grupos de N√∫meros</h3>
                        <div class="group-stats">
                            ${Object.entries(prediction.prediction_groups || {}).map(([groupName, numbers]) => `
                                <div class="group-item">
                                    <h4>${groupName.replace('group_', 'Grupo ')}</h4>
                                    <div>${numbers.join(', ')}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultsDiv.innerHTML = `
                    <div class="error">‚ùå Error al generar predicci√≥n: ${error.message}</div>
                `;
            }
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
        
        // Cargar estad√≠sticas autom√°ticamente al cargar la p√°gina
        window.addEventListener('load', testStats);
    </script>
</body>
</html>